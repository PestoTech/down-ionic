<ion-view id="events"
          view-title="Rallytap"
          hide-back-button="true"
          can-swipe-back="false">
  <ion-content>
    <ion-refresher pulling-text="Pull to refresh..."
                   on-refresh="events.refresh()"
                   ng-if="!events.isLoading"
                   spinner="bubbles">
    </ion-refresher>
    <div id="create-event-container">
      <i class="calendar-star-selected"></i>
      <input id="create-event-prompt"
             readonly
             ng-mousedown="events.createEvent()"
             ontouchstart
             placeholder="What sounds fun?">
    </div>
    <ion-list>
      <ion-item ng-repeat="item in events.items"
                ng-class="{'item-divider': item.isDivider}">
        <!-- Divider -->
        <div ng-if="item.isDivider">
          <span class="divider-title">{{item.title}}</span>
          <div class="divider-line"></div>
        </div>

        <!-- Event -->
        <div class="saved-event item-button-left" ng-if="item.savedEvent">
          <button class="button mark-interested"
                  ng-disabled="events.didUserSaveEvent(item.savedEvent)"
                  ng-mousedown="events.saveEvent(item.savedEvent.event)"
                  ontouchstart>
            <i class="icon"
               ng-class="{
                 'calendar-star-selected': events.didUserSaveEvent(item.savedEvent),
                 'calendar-star-default': !events.didUserSaveEvent(item.savedEvent)
               }"></i>
            <span class="total-num-interested">{{item.savedEvent.totalNumInterested}}76</span>
          </button>
          <h2>
             {{item.savedEvent.event.title}}<span
             ng-if="item.savedEvent.event.place"
             > at {{item.savedEvent.event.place.name}}</span><span
             ng-if="item.savedEvent.event.datetime"
             > &mdash; {{item.savedEvent.event.datetime | date:"EEE, MMM d 'at' h:mm a"}}</span>
          </h2>
          <div class="date-posted">
             posted 7 minutes ago
          </div>
          <div class="extra-details"
               ng-if="item.savedEvent.event.title==='Get jiggy with it'">
               <!--ng-if="events.didUserSaveEvent(item.savedEvent)">-->
            <span class="section interested"
                  ng-if="item.savedEvent.numInterestedFriends > 0">interested</span>
            <span class="section">comment</span>
            <div class="item item-avatar item-button-right"
                 ng-repeat="friend in item.savedEvent.interestedFriends">
              <img class="item-image" ng-src="{{friend.getImageUrl(72)}}">
              <h3>{{friend.name}}</h3>
              <button class="button invite"
                      ng-class="{invited: events.wasInvited(friend, item.savedEvent.event)}"
                      ng-disabled="events.wasInvited(friend, item.savedEvent.event)"
                      ng-mousedown="events.invite(friend, item.savedEvent.event)"
                      >Down?</button>
            </div>
          </div>
        </div>
      </ion-item>
    </ion-list>
  </ion-content>
</ion-view>
