!function(t){"use strict";t(angular,Chart)}(function(t,e){"use strict";function n(){var n={},r={Chart:e,getOptions:function(e){var r=e&&n[e]||{};return t.extend({},n,r)}};this.setOptions=function(e,r){return r?void(n[e]=t.extend(n[e]||{},r)):(r=e,void(n=t.extend(n,r)))},this.$get=function(){return r}}function r(n,r){function a(t,e){return t&&e&&t.length&&e.length?Array.isArray(t[0])?t.length===e.length&&t.every(function(t,n){return t.length===e[n].length}):e.reduce(i,0)>0?t.length===e.length:!1:!1}function i(t,e){return t+e}function l(t,e,n){return function(r){var o=e.getPointsAtEvent||e.getBarsAtEvent||e.getSegmentsAtEvent;if(o){var a=o.call(e,r);t[n](a,r),t.$apply()}}}function u(r,o){for(var a=t.copy(o.colours||n.getOptions(r).colours||e.defaults.global.colours);a.length<o.data.length;)a.push(o.getColour());return a.map(c)}function c(t){return"object"==typeof t&&null!==t?t:"string"==typeof t&&"#"===t[0]?f(g(t.substr(1))):s()}function s(){var t=[h(0,255),h(0,255),h(0,255)];return f(t)}function f(t){return{fillColor:d(t,.2),strokeColor:d(t,1),pointColor:d(t,1),pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:d(t,.8)}}function h(t,e){return Math.floor(Math.random()*(e-t+1))+t}function d(t,e){return o?"rgb("+t.join(",")+")":"rgba("+t.concat(e).join(",")+")"}function g(t){var e=parseInt(t,16),n=e>>16&255,r=e>>8&255,o=255&e;return[n,r,o]}function p(e,n,r,o){return{labels:e,datasets:n.map(function(e,n){return t.extend({},o[n],{label:r[n],data:e})})}}function v(e,n,r){return e.map(function(e,o){return t.extend({},r[o],{label:e,value:n[o],color:r[o].strokeColor,highlight:r[o].pointHighlightStroke})})}function y(t,e){var n=t.parent(),r=n.find("chart-legend"),o="<chart-legend>"+e.generateLegend()+"</chart-legend>";r.length?r.replaceWith(o):n.append(o)}function C(t,e,n,r){Array.isArray(n.data[0])?t.datasets.forEach(function(t,n){(t.points||t.bars).forEach(function(t,r){t.value=e[n][r]})}):t.segments.forEach(function(t,n){t.value=e[n]}),t.update(),n.$emit("update",t),n.legend&&"false"!==n.legend&&y(r,t)}function m(t){return!t||Array.isArray(t)&&!t.length||"object"==typeof t&&!Object.keys(t).length}function b(r,o){var a=t.extend({},e.defaults.global,n.getOptions(r),o.options);return a.responsive}return function(e){return{restrict:"CA",scope:{data:"=",labels:"=",options:"=",series:"=",colours:"=?",getColour:"=?",chartType:"=",legend:"@",click:"=",hover:"="},link:function(i,c){function f(n,r){if(!m(n)&&!t.equals(n,r)){var o=e||i.chartType;o&&(d&&d.destroy(),h(o))}}function h(e){if(b(e,i)&&0===c[0].clientHeight&&0===g.clientHeight)return r(function(){h(e)},50);if(i.data&&i.data.length){i.getColour="function"==typeof i.getColour?i.getColour:s,i.colours=u(e,i);var o=c[0],a=o.getContext("2d"),f=Array.isArray(i.data[0])?p(i.labels,i.data,i.series||[],i.colours):v(i.labels,i.data,i.colours),C=t.extend({},n.getOptions(e),i.options);d=new n.Chart(a)[e](f,C),i.$emit("create",d),["hover","click"].forEach(function(t){i[t]&&(o["click"===t?"onclick":"onmousemove"]=l(i,d,t))}),i.legend&&"false"!==i.legend&&y(c,d)}}var d,g=document.createElement("div");g.className="chart-container",c.replaceWith(g),g.appendChild(c[0]),o&&window.G_vmlCanvasManager.initElement(c[0]),i.$watch("data",function(t,n){if(t&&t.length&&(!Array.isArray(t[0])||t[0].length)){var r=e||i.chartType;if(r){if(d){if(a(t,n))return C(d,t,i,c);d.destroy()}h(r)}}},!0),i.$watch("series",f,!0),i.$watch("labels",f,!0),i.$watch("options",f,!0),i.$watch("colours",f,!0),i.$watch("chartType",function(e,n){m(e)||t.equals(e,n)||(d&&d.destroy(),h(e))}),i.$on("$destroy",function(){d&&d.destroy()})}}}}e.defaults.global.responsive=!0,e.defaults.global.multiTooltipTemplate="<%if (datasetLabel){%><%=datasetLabel%>: <%}%><%= value %>",e.defaults.global.colours=["#97BBCD","#DCDCDC","#F7464A","#46BFBD","#FDB45C","#949FB1","#4D5360"];var o="object"==typeof window.G_vmlCanvasManager&&null!==window.G_vmlCanvasManager&&"function"==typeof window.G_vmlCanvasManager.initElement;o&&(e.defaults.global.animation=!1),t.module("chart.js",[]).provider("ChartJs",n).factory("ChartJsFactory",["ChartJs","$timeout",r]).directive("chartBase",function(t){return new t}).directive("chartLine",function(t){return new t("Line")}).directive("chartBar",function(t){return new t("Bar")}).directive("chartRadar",function(t){return new t("Radar")}).directive("chartDoughnut",function(t){return new t("Doughnut")}).directive("chartPie",function(t){return new t("Pie")}).directive("chartPolarArea",function(t){return new t("PolarArea")})});